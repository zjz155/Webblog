{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>首页</title>
    <link rel="stylesheet" href="/static/plugins/bootstrap-4.1.3-dist/css/bootstrap.min.css">
    <link href="/static/css/sticky-footer-navbar.css" rel="stylesheet">


    <!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
    <script src="/static/js/jquery-3.4.1.min.js"></script>

    <!-- popper.min.js 用于弹窗、提示、下拉菜单 -->
    <script src="/static/js/popper.min.js"></script>

    <!-- 最新的 Bootstrap4 核心 JavaScript 文件 -->
    <script src="/static/plugins/bootstrap-4.1.3-dist/js/bootstrap.min.js"></script>


</head>
<body>

 <header>
      <!-- Fixed navbar -->
      <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <a class="navbar-brand" href="#">LIFE IS SHORT</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item ">
              <a class="nav-link" href="/index/html/">首页 <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" href="#">个人中心</a>
            </li>
            <li class="nav-item">
              <a class="nav-link disabled" href="#" >项目介绍</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" id="markdown">Markdown编辑器</a>
            </li>
          </ul>
          <div class="form-inline mt-2 mt-md-0">

              <input class="form-control mr-sm-2" type="text" placeholder="Search" aria-label="Search">
              <button class="btn btn-outline-success my-2 my-sm-0"  id="login">登录</button>&nbsp;&nbsp;
              <button class="btn btn-outline-success my-2 my-sm-0" id="register">注册</button>
          </div>
        </div>
      </nav>
 </header>

<br/>

<div class="container">
    <h2>文章列表项</h2>
    <div class="list-group">
        <a href="#" class="list-group-item list-group-item-action" style="display:none;">
            <h6><b>Default Django settings</b></h6>
            <p class="text-secondary"> <small>插入操作较为简单，当往表中插入记录时，提交事务时会对全文索引上的列进行分词存储到FTS Index Cache，最后在批量更新到Auxiliary Table中.插入操作较为简单，当往表中插入记录时，提交事务时会对全文索引上的列进行分词存储到FTS Index Cache，最后在批量更新到Auxiliary Table中</small></p>

            <span>
                <span><small>2019-04-25 18:01:34</small></span>
                <span><small>|</small></span>
                <span><small>阅读数 10</small></span>
                <span><small>|</small></span>
                <span><small>评论数 0</small></span>
                <span><small>|</small></span>
            </span>
            <sapn>
                <span><small>置顶</small></span>  <span> <small>编辑</small></span>   <span><small>删除</small></span>
            </sapn>

        <a href="#" class="list-group-item list-group-item-action"　style="display:none;">Third item</a>
    </div>
    <br/>

{#        <div class="row">#}
{#            <div class="col-md-4"></div>#}
{#                <div class="col-md-4">#}
{#                    <ul class="pagination">#}
{#                        <li class="page-item"><a class="page-link" href="#">上一页</a></li>#}
{#                        <li class="page-item"><a class="page-link" href="#">1</a></li>#}
{#                        <li class="page-item"><a class="page-link" href="#">下－页</a></li>#}
{#                    </ul>#}
{#            </div>#}
{#        </div>#}


</div>

<footer class="footer">
    <div class="container text-center">
        <span class="text-muted">&copy; 2019-2020</span>
    </div>
</footer>

<script src="/static/js/jquery.min.js"></script>
<script type="text/javascript">
    var login = 0;
     $(function() {

         $.ajax({
             url: "/is_login/",
             type: "get",
             dataType: "json",
             headers:{
                 "Authorization": "Bearer" + " " +  window.localStorage.getItem("token")
             },

             success: function (data, status) {
                 if (data.success) {
                     $("#login").html("退出");
                     $("#register").html(data.username);
                     login = 1
                 }
             },
             error: function (XHR, textStatus, errorThrown) {
                 alert("响应状态=" + textStatus );
             },

         });

         $("#login").click(function(){
             if (login){
                window.localStorage.clear();
                login = 0;
                $("#login").html("登录");
                 $("#register").html("注册");
             }
             else
                 $(window).attr("location", "/login/")

         });

          $("#register").click(function(){
             if ($("#register").html() ==="注册"){
                  $(location).attr("href", "/register/")

             }


         });

          $("#markdown").click(function(){
              if (login)
                  $(window).attr("location", "/compile_blog/");
              else
                  alert("请先登录")

          });

         $.get("/index/1/", function (data, status) {
             html = "";
             for (i=0; i< data.entries.length; i++){
                headline = data.entries[i].headline;
                abstract = data.entries[i].abstract;
                pub_date = data.entries[i].pub_date;
                blog = data.entries[i].blog;
                link = data.entries[i].link;
                console.log(data);
                $("#headline").html(headline);
                $("#abstract").html(abstract);

                html += ' <a href=' + link  + " " + 'class="list-group-item list-group-item-action">';
                html += "<h6><b>" + headline + "</b></h6>";
                html += '<p class="text-secondary"><small>' + abstract + '</small></p>';
                html += "<span><samll style='font-size: 15px'>" + pub_date + "</small></span>";
                html += "<span><small> | </small></span>";
                html += "<span>";

                html += "<span><small >阅读数 10</small></span>";
                html += "<span><small> | </small></span>";
                html += "<span><small>评论数 0</small></span>";
                html += "<span><small> | </small></span>";
                html +="</span>";

                html += "<span>";
                html += "<span><small>置顶</small></span>  <span> <small>编辑</small></span>   <span><small>删除</small></span>"
                html +="</span>";
                html += "</a>";
             }
            $(".list-group").html(html)

         },"json");


      });



</script>

</body>
</html>